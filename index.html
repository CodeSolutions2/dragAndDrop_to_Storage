<!DOCTYPE html>
<html>
<head></head>
<body>

<button id="plot_histogram_graph" onclick="plot_histogram_graph()" style="display:block;">plot_histogram_graph</button>
<button id="plot_bar_graph" onclick="plot_bar_graph()" style="display:block;">plot_bar_graph</button>

<div id="data_display" style="display:block; text-align: left; width: 600px;"></div>
	

<script src='https://d3js.org/d3.v7.min.js'></script>


<script>
	


  
async function plot_histogram_graph() {
	
	const dataArray = [30, 50, 80, 120, 200];

	// ---------------------------------------------------

	// Obtain information about data
	const [min_val, max_val] = await min_max_of_array(dataArray);
	console.log("min_val: ", min_val);
	console.log("max_val: ", max_val);
	
	// ---------------------------------------------------
	
	// Verify the contents of the frequency data
	const svg = d3.select("#data_display").append("svg");
	// const svg = d3.select(".chart").append("svg").attr("width", 400).attr("height", 200);

	// Create a histogram generator
	var histogram = d3.histogram().domain([0, dataArray.length]).thresholds(d3.range(min_val, max_val));

	// Generate the histogram bins
	var bins = histogram(dataArray);
	
	// Create the bars for the histogram
	svg.selectAll("rect")
	    .data(bins)
	    .enter()
	//     .append("rect")
	//     .attr("x", function(d,i) { console('d.x0: ', d.x0); return i; })
	//     .attr("y", function(d) { return d; })
	//     .attr("width", function(d) { return d.x1 - d.x0 - 1; })
	//     .attr("height", function(d) { return d.length * 5; })
	//     .attr("fill", "steelblue");

}



async function min_max_of_array(arr) {
  const arr_sort = arr.sort();
  return [arr_sort.at(0), arr_sort.at(arr.length-1)];
}

  
async function plot_bar_graph() {
	
	const dataArray = [30, 50, 80, 120, 200];

	// ---------------------------------------------------
	
	const [min_val, max_val] = await min_max_of_array(dataArray);
	console.log("min_val: ", min_val);
	console.log("max_val: ", max_val);

	// ---------------------------------------------------

	const w = 400;
	const h = 400;

	// Plot data on chart, Add bars to the chart
	const bar_width = Math.floor((w/dataArray.length)/2);
	console.log("bar_width: ", bar_width);

	const x_buffer = Math.floor(0.05*bar_width);   // The x-axis space between each bar, 10 percent of bar_width
	console.log("x_buffer: ", x_buffer); 

	// ---------------------------------------------------
	
	const x_scale = d3.scaleBand()
		.domain(dataArray.map((d,i) => i))
		.range([0, w])
		.padding(x_buffer);

	// domain = the y-value range of the bars
	const y_scale = d3.scaleLinear()
		.domain([min_val, max_val])
		.nice()
		.range([h, 0]);
	
	// ---------------------------------------------------
	
	const svg = d3.select("#data_display").append("svg");
	//.attr('width', w).attr('height', h);
	console.log("svg: ", svg);
	
	// width = bar_width
	// height = bar_height, the dataArray values
	// x = the (x-location) of each bar
	// y = the (y-location) of each bar
	svg.selectAll('mybar')
		.data(dataArray)
		.enter()
		.append('rect')
		.attr('width', bar_width)
		.attr('height', d => h-d)
		.attr('x', (d,i) => x_scale(i * (bar_width + x_buffer)))
		.attr('y', (d,i) => y_scale(d))
		.attr("fill", "steelblue");
}



</script>

  
</body>
</html>

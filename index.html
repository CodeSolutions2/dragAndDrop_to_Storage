<!DOCTYPE html>
<html>
<head></head>
<body>

<button id="plot_line_graph" onclick="plot_line_graph()" style="display:block;">plot_line_graph</button>
<button id="plot_line_graph_dataObject" onclick="plot_line_graph_dataObject()" style="display:block;">plot_line_graph_dataObject</button>
<button id="plot_line_graph_dataArray" onclick="plot_line_graph_dataArray()" style="display:block;">plot_line_graph_dataArray</button>
<button id="plot_bar_graph" onclick="plot_bar_graph()" style="display:block;">plot_bar_graph</button>

<div id="data_display" style="display:block; text-align: left; width: 600px;"></div>
	

<script src='https://d3js.org/d3.v7.min.js'></script>


<script>
	


  
async function plot_line_graph() {
	
	const dataArray = [30, 50, 80, 120, 200];
	
	// ---------------------------------------------------
	
	// Declare the chart dimensions and margins
	const width = 928;
	const height = 500;
	const marginTop = 20;
	const marginRight = 30;
	const marginBottom = 30;
	const marginLeft = 40;

	// ---------------------------------------------------

	// Obtain information about data
	const [min_val, max_val] = await min_max_of_array(dataArray);
	console.log("min_val: ", min_val);
	console.log("max_val: ", max_val);
	
	// ---------------------------------------------------
	
	// x, y scaling variables
	// Declare the x (horizontal position) scale.
	const x_scale = d3.scaleLinear([0, dataArray.length], [marginLeft, width - marginRight]);

	// Declare the y (vertical position) scale.
	const y_scale = d3.scaleLinear([min_val, max_val], [height - marginBottom, marginTop]);
  
	// ---------------------------------------------------

	// Declare the line generator
	const line = d3.line()
		.x((d, i) => x_scale(i))
		.y(d => y_scale(d));

	// ---------------------------------------------------

	// Create the SVG container
	const svg = d3.select("#data_display")
		.append("svg")
		//.create("svg")
		.attr("class", 'line')
		.attr("width", width)
		.attr("height", height)
		.attr("viewBox", [0, 0, width, height])
		.attr("style", "max-width: 100%; height: auto; height: intrinsic;");

	// ---------------------------------------------------
	
	// Add the x-axis
	svg.append("g")
		.attr('class', 'x-axis')
		.attr("transform", `translate(0,${height - marginBottom})`)
		.call(d3.axisBottom(x_scale).ticks(width / 80).tickSizeOuter(0));
	
	// Add the y-axis, remove the domain line, add grid lines and a label.
	svg.append("g")
		.attr('class', 'y-axis')
		.attr("transform", `translate(${marginLeft},0)`)
	 	.call(d3.axisLeft(y_scale).ticks(height / 40))
		.call(g => g.select(".domain").remove())
		.call(g => g.selectAll(".tick line").clone()
			.attr("x2", width - marginLeft - marginRight)
			.attr("stroke-opacity", 0.1))
	 	.call(g => g.append("text")
			.attr("x", -marginLeft)
	 		.attr("y", 10)
	 		.attr("fill", "currentColor")
	 		.attr("text-anchor", "start")
	 		.text("Title"));
	
	// Append a path for the line
	svg.append("path")
		// .datum(dataArray)
		.attr("fill", "none")
		.attr("stroke", "steelblue")
		.attr("stroke-width", 3)
		.attr("d", line(dataArray));

}


async function plot_line_graph_dataObject() {

	const data = [
            { x: 0, y: 10 },
            { x: 1, y: 20 },
            { x: 2, y: 15 },
            { x: 3, y: 25 },
            { x: 4, y: 18 }
        ];

	const width = 928;
	const height = 500;

        const svg = d3.select("#data_display")
		.append("svg")
		.attr("class", 'line')
		.attr("width", width)
		.attr("height", height);

        const xScale = d3.scaleLinear()
            .domain([0, d3.max(data, d => d.x)])
            .range([0, width]);

        const yScale = d3.scaleLinear()
            .domain([0, d3.max(data, d => d.y)])
            .range([height, 0]);

        const line = d3.line()
            .x(d => xScale(d.x))
            .y(d => yScale(d.y));

        svg.append("path")
            .datum(data)
            .attr("fill", "none")
            .attr("stroke", "steelblue")
            .attr("stroke-width", 2)
            .attr("d", line);
	
}

async function plot_line_graph_dataArray() {

	const dataArray = [30, 50, 80, 120, 200];

	const width = 928;
	const height = 500;

        const svg = d3.select("#data_display")
		.append("svg")
		.attr("class", 'line')
		.attr("width", width)
		.attr("height", height);

        const xScale = d3.scaleLinear()
            .domain([0, d3.max(dataArray, (d,i) => i)])
            .range([0, width]);

        const yScale = d3.scaleLinear()
            .domain([0, d3.max(dataArray, d => d)])
            .range([height, 0]);

        const line = d3.line()
		.x((d, i) => x_scale(i))
		.y(d => y_scale(d));

        svg.append("path")
            .datum(dataArray)
            .attr("fill", "none")
            .attr("stroke", "steelblue")
            .attr("stroke-width", 2)
            .attr("d", line);
	
}


async function min_max_of_array(arr) {
  const arr_sort = arr.sort();
  return [arr_sort.at(0), arr_sort.at(arr.length-1)];
}

  
async function plot_bar_graph() {
	
	const dataArray = [30, 50, 80, 120, 200];

	// ---------------------------------------------------
	
	const [min_val, max_val] = await min_max_of_array(dataArray);
	console.log("min_val: ", min_val);
	console.log("max_val: ", max_val);

	// ---------------------------------------------------

	const w = 400;
	const h = 400;

	// Plot data on chart, Add bars to the chart
	const bar_width = Math.floor((w/dataArray.length)/2);
	console.log("bar_width: ", bar_width);

	const x_buffer = Math.floor(0.05*bar_width);   // The x-axis space between each bar, 10 percent of bar_width
	console.log("x_buffer: ", x_buffer); 

	// ---------------------------------------------------
	
	const x_scale = d3.scaleBand()
		.domain(dataArray.map((d,i) => i))
		.range([0, w])
		.padding(x_buffer);

	// domain = the y-value range of the bars
	const y_scale = d3.scaleLinear()
		.domain([0, max_val])
		.range([h, 0]);
	
	// ---------------------------------------------------
	
	const svg = d3.select("#data_display").append("svg");
	//.attr('width', w).attr('height', h);
	console.log("svg: ", svg);
	
	// width = bar_width
	// height = bar_height, the dataArray values
	// x = the (x-location) of each bar
	// y = the (y-location) of each bar
	svg.selectAll('rect')
		.data(dataArray)
		.enter()
		.append('rect')
		.attr('width', bar_width)
		.attr('height', d => h-d)
		.attr('x', (d,i) => i * (bar_width + x_buffer))
		.attr('y', (d,i) => d)
		//.attr('height', d => y_scale(h-d))
		//.attr('x', (d,i) => x_scale(i))
		//.attr('y', (d,i) => y_scale(d))
		.attr("fill", "steelblue");
}



</script>

  
</body>
</html>

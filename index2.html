<!DOCTYPE html>
<html>
<head></head>
<body>

<input id="location_name" type="text" value="" placeholder="location_name" rows="10" cols="100" style="display:block; text-align: left; width: 600px;">

<button id="run_selection_w_JSONP" onclick="run_selection_w_JSONP()">run_selection_w_JSONP</button>
<button id="run_selection_w_CORS" onclick="run_selection_w_CORS()">run_selection_w_CORS</button>

	
<!-- <script src='https://code.jquery.com/jquery-3.6.3.min.js'></script> -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<!-- <script type="text/javascript" crossorigin> -->
<!-- function func_callback(response) { -->
<!--   var meta = response.meta; -->
<!--   var data = response.data; -->
<!--   console.log(meta); -->
<!--   console.log(data); -->
<!-- } -->
<!-- var script = document.createElement('script'); -->
<!-- script.src = `https://nominatim.openstreetmap.org/search?q=${document.getElementById('location_name').innerHTML}&format=json?callback=func_callback` -->
<!-- document.getElementsByTagName('head')[0].appendChild(script); -->
<!-- </script> -->

<script>
	
// -----------------------------------------------
	
window.addEventListener('beforeunload', function() {
    window.location.href = window.location.href + '?nocache=' + new Date().getTime();
});

// -----------------------------------------------

var url = `https://nominatim.openstreetmap.org/search?q=${document.getElementById('location_name').innerHTML}&format=json`;

// -----------------------------------------------
	
async function run_selection_w_JSONP() {
	
	var settings = {
		type: 'GET',
		url: url,
		dataType: 'jsonp',
		jsonpCallback: 'myCallBackMethod',
		async: false, // this is by default false, so not need to mention
		crossDomain: true // tell the browser to allow cross domain calls.
		// success: successResopnse, jsonpCallback will call the successCallback
		// error: failureFunction jsonp does not support errorCallback. So cannot use this 
	};
	
	$.ajax(settings);

	window.myCallBackMethod = function(data) { successResponse(data); }
		 
	successResponse = function(data) { console.log("response: ", response); }

}

// -----------------------------------------------
	
async function run_selection_w_CORS() {

  var settings = {
		url: url,
		type : 'GET',
		dataType: 'json',
		async: true,
		crossDomain: true,
		success: function(response) { console.log(response); },
		error: function(xhr, status, error) { console.log('Error:', error); }
	};

  $.ajax(settings).done(function(response) { console.log('response: ', response); })

// OpaqueResponseBlocking error occurs because the browser blocks the response due to cross-origin restrictions. This typically happens when the requested resource is on a different domain or protocol than the origin of the request.

// jQuery363000451280049135816_1720786311751 was not called
}

// -----------------------------------------------

</script>

  
</body>
</html>
